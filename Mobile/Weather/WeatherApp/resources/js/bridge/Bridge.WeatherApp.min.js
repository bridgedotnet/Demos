Bridge.assembly("Bridge.WeatherApp",function($asm){"use strict";Bridge.define("WeatherApp.App",{statics:{fields:{key:null,weatherUrl:null},ctors:{init:function(){this.key="c53b1d4229bccdc8";this.weatherUrl="http://api.wunderground.com/api/{0}/forecast/geolookup/conditions/q/{1},{2}.json";Bridge.ready(this.Main)}},methods:{Main:function(){var $t;WeatherApp.App.GetForecast();$(($t=document.createElement("button"),$t.type="button",$t.className="btn btn-primary",$t.innerHTML='<span class="glyphicon glyphicon-refresh"><\/span>',$t.onclick=WeatherApp.App.UpdateButton_Click,$t)).appendTo("#btnDiv")},GetForecast:function(){Bridge.global.navigator.geolocation.getCurrentPosition($asm.$.WeatherApp.App.f1)},GetWeather:function(lat,lng){$.getJSON(System.String.format(WeatherApp.App.weatherUrl,WeatherApp.App.key,Bridge.box(lat,System.Double,System.Double.format,System.Double.getHashCode),Bridge.box(lng,System.Double,System.Double.format,System.Double.getHashCode)),null,$asm.$.WeatherApp.App.f2).fail($asm.$.WeatherApp.App.f3)},UpdateButton_Click:function(){WeatherApp.App.GetForecast()}}},$entryPoint:!0});Bridge.ns("WeatherApp.App",$asm.$);Bridge.apply($asm.$.WeatherApp.App,{f1:function(position){WeatherApp.App.GetWeather(position.coords.latitude,position.coords.longitude)},f2:function(data){var $t,$t1,$t2,$t3,$t4,selectedMetric=$("input[type='radio'][name='metric']:checked"),metric=selectedMetric.length>0?selectedMetric.val():"c",location=($t=data.location).city,temp=($t1=data.current_observation)[System.Array.index(System.String.concat("temp_",metric),$t1)],img=($t2=data.current_observation).icon_url,desc=($t3=data.current_observation).weather,wind=($t4=data.current_observation).wind_string;$("#location").html(location.toString());$("#temp").html(temp.toString());$("#desc").html(desc.toString());$("#wind").html(wind.toString());$("#img").attr("src",img.toString());$(System.String.concat("#",metric)).attr("checked","checked").parent().addClass("active")},f3:function(){Bridge.global.alert("Key required to call the Weather Underground API not found.")}})});